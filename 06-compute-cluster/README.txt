For code see the 'fine' branch at http://github.com/lloyd/fully_loaded_node
and the code at github.com/lloyd/compute-cluster